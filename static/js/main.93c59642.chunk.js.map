{"version":3,"sources":["store/listingActions.ts","components/general/popup.tsx","components/general/errorHandler.tsx","store/errorContext.ts","store/listingReducer.ts","store/listingStore.tsx","utility/currencyFormatter.ts","store/listingHooks.ts","components/listingTable.tsx","api/mlspin.ts","api/osmNominatim.ts","utility/delayQueue.ts","components/sourceInputPopup.tsx","styles/images/marker-shadow.png","components/listingMap.tsx","styles/images/marker-icon-blue.png","styles/images/marker-icon-violet.png","components/main.tsx","styles/theme.ts","App.tsx","index.tsx"],"names":["ListingActionType","useStyles","makeStyles","buttonsContainer","padding","display","flexDirection","justifyContent","Popup","title","isOpen","confirmButtonLabel","disableConfirmButton","hideCancelButton","children","onConfirm","onCancel","onExited","classes","Dialog","open","maxWidth","DialogTitle","DialogContent","DialogActions","className","Button","onClick","variant","disabled","ErrorHandler","props","state","error","this","setState","errors","undefined","length","resetErrors","map","e","i","Typography","React","ErrorContext","createContext","addError","clearAll","ListingActions","setIsImporting","createAction","SetIsImporting","addListings","AddListings","deleteListings","DeleteListings","selectListing","SelectListing","addCoordinate","AddCoordinate","deleteCoordinates","DeleteCoordinates","setHiddenListings","SetHiddenListings","setListingAsViewed","SetListingAsViewed","listingReducer","action","type","isImporting","payload","ids","Set","listings","l","id","filteredListings","filter","has","add","some","coordinates","c","hiddenListingIds","listing","isViewed","initialListingStore","selectedListingId","ListingContext","ListingFullContext","store","dispatch","cachedStore","cacheEntry","localStorage","getItem","serializedStore","JSON","parse","receivedTime","Date","err","console","log","ListingProvider","useReducer","useEffect","setItem","stringify","Provider","value","currencyFormatter","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","useListingAction","actionType","useContext","useMemo","actionCreatorKey","Object","keys","find","k","getType","Error","actionCreator","columns","field","headerName","flex","valueGetter","params","row","address","street","disableColumnMenu","unit","city","valueFormatter","format","valueOf","date","setDate","getDate","initialDateFilter","getFullYear","getMonth","toString","padStart","initialFilterModel","items","columnField","operatorValue","ListingTable","memo","setSelectedListingId","setHiddenListingIds","onFilterModelChanged","useCallback","visibleRows","onRowSelected","data","selectionModel","rows","autoHeight","disableMultipleSelection","pagination","pageSize","rowsPerPageOptions","filterModel","onFilterModelChange","scrapeSourceForListings","listingPage","a","parser","DOMParser","doc","parseFromString","listingRows","querySelectorAll","forEach","listingId","parseInt","getAttribute","bedBaths","parseBedAndBathCounts","item","textContent","addressFull","parsedAddress","parseAddress","now","rawDate","toDateString","rawTime","toTimeString","parsedTime","replace","push","price","parsePrice","bedCount","bathCount","Promise","resolve","success","content","matches","exec","groups","addressLine","match","trim","unitOffset","indexOf","slice","priceString","priceMatch","geocodeQueue","delay","_delay","_queue","_isTicking","promise","reject","startTick","force","setTimeout","pop","bind","nextItem","shift","lookupGeocodeAddress","addressQuery","toLocaleUpperCase","randomOffset","Math","random","PI","latitude","sin","longitude","cos","waitNext","query","q","limit","addressdetails","countrycodes","fetch","querystring","encode","response","ok","status","json","coordinate","parseFloat","lat","lon","coordinateJson","sourceInput","width","SourceInputPopup","close","useState","sourceString","setSourceString","errorContext","parseAndSaveListings","parseResult","coordinatesResult","TextField","multiline","fullWidth","rowsMax","placeholder","onChange","s","currentTarget","height","margin","listingType","textTransform","blueMarkerIcon","Icon","iconUrl","shadowUrl","MarkerShadow","iconSize","iconAnchor","popupAnchor","shadowSize","purpleMarkerIcon","ListingMap","listingContext","markListingAsViewed","mapRef","useRef","Grid","MapContainer","center","zoom","scrollWheelZoom","whenCreated","current","TileLayer","attribution","url","reduce","markers","Marker","position","eventHandlers","click","_","icon","container","direction","alignItems","component","toLocaleDateString","month","day","color","newTab","window","opener","openListing","mainContainer","addButton","top","right","bottom","left","Main","setErrors","isSourceInputOpen","setIsSourceInputOpen","listingDateExpiration","activeListingIds","listingsToDelete","coordinatesToDelete","Fab","size","aria-label","DefaultTheme","createMuiTheme","palette","shape","borderRadius","overrides","MuiCssBaseline","body","fontFamily","join","html","App","ThemeProvider","theme","CssBaseline","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.93c59642.chunk.js","sourcesContent":["import { ActionType, createAction } from 'typesafe-actions';\r\nimport { Listing } from '../schemas/listing';\r\nimport { ListingCoordinates } from '../schemas/listingCoordinates';\r\n\r\nexport enum ListingActionType {\r\n    SetIsImporting = 'SET_IS_IMPORTING',\r\n    AddListings = 'ADD_LISTINGS',\r\n    DeleteListings = 'DELETE_LISTINGS',\r\n    SelectListing = 'SELECT_LISTING',\r\n    AddCoordinate = 'ADD_COORDINATE',\r\n    DeleteCoordinates = 'DELETE_COORDINATES',\r\n    SetHiddenListings = 'SET_HIDDEN_LISTINGS',\r\n    SetListingAsViewed = 'SET_LISTING_AS_VIEWED',\r\n}\r\n\r\nexport const ListingActions = {\r\n    setIsImporting: createAction(ListingActionType.SetIsImporting)<boolean>(),\r\n    addListings: createAction(ListingActionType.AddListings)<Listing[]>(),\r\n    deleteListings: createAction(ListingActionType.DeleteListings)<number[]>(),\r\n    selectListing: createAction(ListingActionType.SelectListing)<number | null>(),\r\n    addCoordinate: createAction(ListingActionType.AddCoordinate)<ListingCoordinates>(),\r\n    deleteCoordinates: createAction(ListingActionType.DeleteCoordinates)<number[]>(),\r\n    setHiddenListings: createAction(ListingActionType.SetHiddenListings)<number[] | null>(),\r\n    setListingAsViewed: createAction(ListingActionType.SetListingAsViewed)<number>(),\r\n};\r\n\r\nexport type ListingAction = ActionType<typeof ListingActions>;\r\n","import React, { FC, ReactNode } from 'react';\r\nimport { Dialog, DialogTitle, DialogContent, DialogActions, Button, makeStyles } from '@material-ui/core';\r\n\r\ninterface PopupProps {\r\n    title: string;\r\n    isOpen: boolean;\r\n    confirmButtonLabel: string;\r\n    disableConfirmButton?: boolean;\r\n    hideCancelButton?: boolean;\r\n    children?: ReactNode;\r\n    onConfirm: () => void;\r\n    onCancel?: () => void;\r\n    onExited?: () => void;\r\n}\r\n\r\nexport const useStyles = makeStyles(() => ({\r\n    buttonsContainer: {\r\n        padding: '1.5rem',\r\n        display: 'flex',\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n    },\r\n}));\r\n\r\nexport const Popup: FC<PopupProps> = ({\r\n    title,\r\n    isOpen,\r\n    confirmButtonLabel,\r\n    disableConfirmButton,\r\n    hideCancelButton,\r\n    children,\r\n    onConfirm,\r\n    onCancel,\r\n    onExited,\r\n}: PopupProps) => {\r\n    const classes = useStyles();\r\n\r\n    return (\r\n        <Dialog open={isOpen} maxWidth={false} onExited={onExited}>\r\n            <DialogTitle>{title}</DialogTitle>\r\n            <DialogContent>{children}</DialogContent>\r\n            <DialogActions className={classes.buttonsContainer}>\r\n                {!hideCancelButton && (\r\n                    <Button onClick={onCancel} variant=\"outlined\">\r\n                        Cancel\r\n                    </Button>\r\n                )}\r\n                <Button onClick={onConfirm} variant=\"contained\" disabled={disableConfirmButton}>\r\n                    {confirmButtonLabel}\r\n                </Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n    );\r\n};\r\n","import { Typography } from '@material-ui/core';\r\nimport * as React from 'react';\r\nimport { Popup } from './popup';\r\n\r\ninterface ErrorHandlerProps {\r\n    children?: React.ReactNode;\r\n}\r\n\r\ninterface ErrorHandlerState {\r\n    errors?: Error[];\r\n}\r\n\r\n// This component is an application-wide error boundary that can catch\r\n// errors thrown in lower components, log them, and display them to the\r\n// user via a popup dialog\r\nexport class ErrorHandler extends React.Component<ErrorHandlerProps, ErrorHandlerState> {\r\n    constructor(props: ErrorHandlerProps, state: ErrorHandlerState) {\r\n        super(props, state);\r\n        this.state = {};\r\n    }\r\n\r\n    componentDidCatch(error: Error) {\r\n        this.setState({ errors: [...(this.state.errors || []), error] });\r\n    }\r\n\r\n    private resetErrors() {\r\n        this.setState({ errors: undefined });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <Popup\r\n                    title=\"Error\"\r\n                    isOpen={this.state !== null && this.state.errors !== undefined && this.state.errors.length > 0}\r\n                    confirmButtonLabel=\"Ok\"\r\n                    hideCancelButton\r\n                    onConfirm={this.resetErrors}\r\n                    onExited={this.resetErrors}\r\n                >\r\n                    {this.state.errors?.map((e, i) => (\r\n                        <Typography key={i}>{e}</Typography>\r\n                    ))}\r\n                </Popup>\r\n                {this.props.children}\r\n            </>\r\n        );\r\n    }\r\n}\r\n","import React from 'react';\r\n\r\ninterface ErrorContextType {\r\n    errors: string[] | null;\r\n    addError: (error: string) => void;\r\n    clearAll: () => void;\r\n}\r\n\r\nexport const ErrorContext = React.createContext<ErrorContextType>({\r\n    errors: null,\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    addError: (error: string) => {},\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    clearAll: () => {},\r\n});\r\n","import { ListingAction, ListingActionType } from './listingActions';\r\nimport { ListingStore } from './listingStore';\r\n\r\nexport const listingReducer = (state: ListingStore, action: ListingAction): ListingStore => {\r\n    switch (action.type) {\r\n        case ListingActionType.SetIsImporting:\r\n            return {\r\n                ...state,\r\n                isImporting: action.payload,\r\n            };\r\n        case ListingActionType.AddListings: {\r\n            // Ensure that there are no duplicate listings included\r\n            const ids = new Set<number>(state.listings?.map((l) => l.id));\r\n            const filteredListings = action.payload.filter((l) => {\r\n                if (ids.has(l.id)) {\r\n                    return false;\r\n                } else {\r\n                    ids.add(l.id);\r\n                    return true;\r\n                }\r\n            });\r\n\r\n            return {\r\n                ...state,\r\n                listings: [...(state.listings ?? []), ...filteredListings],\r\n            };\r\n        }\r\n        case ListingActionType.DeleteListings:\r\n            if (!action.payload.length) {\r\n                return state;\r\n            }\r\n\r\n            return {\r\n                ...state,\r\n                listings: state.listings?.filter((l) => !action.payload.some((id) => id === l.id)) ?? null,\r\n            };\r\n        case ListingActionType.AddCoordinate:\r\n            // Ensure that this coordinate does not already exist\r\n            if (state.coordinates?.some((c) => c.id === action.payload.id)) {\r\n                return state;\r\n            }\r\n\r\n            return {\r\n                ...state,\r\n                coordinates: [...(state.coordinates ?? []), action.payload],\r\n            };\r\n        case ListingActionType.DeleteCoordinates:\r\n            if (!action.payload.length) {\r\n                return state;\r\n            }\r\n\r\n            return {\r\n                ...state,\r\n                coordinates: state.coordinates?.filter((c) => !action.payload.some((id) => id === c.id)) ?? null,\r\n            };\r\n        case ListingActionType.SetHiddenListings:\r\n            return {\r\n                ...state,\r\n                hiddenListingIds: action.payload?.length ? new Set(action.payload) : null,\r\n            };\r\n        case ListingActionType.SetListingAsViewed:\r\n            return {\r\n                ...state,\r\n                listings:\r\n                    state.listings?.map((listing) => {\r\n                        if (listing.id !== action.payload) {\r\n                            return listing;\r\n                        }\r\n\r\n                        return { ...listing, isViewed: true };\r\n                    }) ?? null,\r\n            };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\n","import React, { Dispatch, FC } from 'react';\r\nimport { Listing } from '../schemas/listing';\r\nimport { ListingCoordinates } from '../schemas/listingCoordinates';\r\nimport { ListingAction } from './listingActions';\r\nimport { listingReducer } from './listingReducer';\r\n\r\nexport const initialListingStore = {\r\n    isImporting: false,\r\n    selectedListingId: null as number | null,\r\n    listings: null as Listing[] | null,\r\n    coordinates: null as ListingCoordinates[] | null,\r\n    hiddenListingIds: null as Set<number> | null,\r\n};\r\n\r\nexport type ListingStore = Readonly<typeof initialListingStore>;\r\n\r\ntype ListingStoreAndDispatcher = {\r\n    store: ListingStore;\r\n    dispatch: Dispatch<ListingAction>;\r\n};\r\n\r\nexport const ListingContext = React.createContext<ListingStore>({ ...initialListingStore });\r\n\r\nexport const ListingFullContext = React.createContext<ListingStoreAndDispatcher>({\r\n    store: { ...initialListingStore },\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    dispatch: () => {},\r\n});\r\n\r\nlet cachedStore: ListingStore | null = null;\r\ntry {\r\n    const cacheEntry = localStorage.getItem('listingStore');\r\n    if (cacheEntry?.length) {\r\n        const serializedStore = JSON.parse(cacheEntry);\r\n        if (serializedStore) {\r\n            cachedStore = {\r\n                ...serializedStore,\r\n                listings: serializedStore.listings?.map((l: Listing) => {\r\n                    return {\r\n                        ...l,\r\n                        receivedTime: new Date(l.receivedTime),\r\n                    } as Listing;\r\n                }),\r\n                isImporting: false,\r\n                selectedListingId: null,\r\n                hiddenListingIds: null,\r\n            } as ListingStore;\r\n        }\r\n    }\r\n} catch (err) {\r\n    console.log(`Error serializing store cache: ${err}`);\r\n}\r\n\r\ntype ListingProviderProps = {\r\n    children: JSX.Element;\r\n};\r\n\r\nexport const ListingProvider: FC<ListingProviderProps> = ({ children }: ListingProviderProps) => {\r\n    const [store, dispatch] = React.useReducer(listingReducer, cachedStore ?? (initialListingStore as ListingStore));\r\n    React.useEffect(() => {\r\n        // Every time the store changes, cache it to local storage\r\n        localStorage.setItem(\r\n            'listingStore',\r\n            JSON.stringify({\r\n                ...store,\r\n                hiddenListingIds: [],\r\n            })\r\n        );\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [store.listings, store.coordinates]);\r\n\r\n    return (\r\n        <ListingContext.Provider value={store}>\r\n            <ListingFullContext.Provider value={{ store, dispatch }}>{children}</ListingFullContext.Provider>\r\n        </ListingContext.Provider>\r\n    );\r\n};\r\n","export const currencyFormatter = new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency: 'USD',\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n});\r\n","import React, { useMemo } from 'react';\r\nimport { ActionCreator, EmptyActionCreator, getType, PayloadActionCreator } from 'typesafe-actions';\r\nimport { ListingActions, ListingActionType } from './listingActions';\r\nimport { ListingFullContext } from './listingStore';\r\n\r\ntype ActionForListingActionType<T extends ListingActionType> = {\r\n    [P in keyof typeof ListingActions]: typeof ListingActions[P] extends PayloadActionCreator<T, infer TPayload>\r\n        ? (payload: TPayload) => void\r\n        : typeof ListingActions[P] extends EmptyActionCreator<T>\r\n        ? () => void\r\n        : never;\r\n}[keyof typeof ListingActions];\r\n\r\n//type PickListingAction<K extends ListingActionType> = ReturnType<ListingAction[]>;\r\n\r\nexport const useListingAction = <T extends ListingActionType>(actionType: T): ActionForListingActionType<T> => {\r\n    const { dispatch } = React.useContext(ListingFullContext);\r\n    const action = useMemo(() => {\r\n        const actionCreatorKey = Object.keys(ListingActions).find(\r\n            (k) => getType(ListingActions[k as keyof typeof ListingActions] as ActionCreator<string>) === actionType\r\n        ) as keyof typeof ListingActions;\r\n        if (!actionCreatorKey) {\r\n            throw new Error(`Could not find action for type ${actionType}`);\r\n        }\r\n\r\n        const actionCreator = ListingActions[actionCreatorKey];\r\n\r\n        return (...args: unknown[]) => {\r\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n            // @ts-ignore\r\n            dispatch(actionCreator(...args));\r\n        };\r\n    }, [dispatch, actionType]);\r\n\r\n    return action as ActionForListingActionType<T>;\r\n};\r\n","import React, { FC } from 'react';\r\nimport { ListingContext } from '../store/listingStore';\r\nimport {\r\n    DataGrid,\r\n    GridColDef,\r\n    GridFilterModelParams,\r\n    GridFilterModelState,\r\n    GridRowSelectedParams,\r\n} from '@material-ui/data-grid';\r\nimport { currencyFormatter } from '../utility/currencyFormatter';\r\nimport { useListingAction } from '../store/listingHooks';\r\nimport { ListingActionType } from '../store/listingActions';\r\n// import { ErrorContext } from '../context/errorContext';\r\n\r\nconst columns: GridColDef[] = [\r\n    {\r\n        field: 'address',\r\n        headerName: 'Address',\r\n        flex: 1.7,\r\n        valueGetter: (params) => params.row.address.street,\r\n        disableColumnMenu: true,\r\n    },\r\n    {\r\n        field: 'unit',\r\n        headerName: 'Unit',\r\n        flex: 0.5,\r\n        valueGetter: (params) => params.row.address.unit,\r\n        disableColumnMenu: true,\r\n    },\r\n    { field: 'type', headerName: 'Type', type: 'string', flex: 1 },\r\n    { field: 'city', headerName: 'City', flex: 1, valueGetter: (params) => params.row.address.city },\r\n    {\r\n        field: 'price',\r\n        headerName: 'Price',\r\n        flex: 0.8,\r\n        type: 'number',\r\n        valueFormatter: (params) => currencyFormatter.format((params.value?.valueOf() as number) ?? 0),\r\n    },\r\n    { field: 'bedCount', headerName: 'Beds', type: 'number', flex: 0.7 },\r\n    { field: 'bathCount', headerName: 'Baths', type: 'number', flex: 0.7 },\r\n    { field: 'receivedTime', headerName: 'Date', type: 'date', flex: 0.8 },\r\n];\r\n\r\nconst date = new Date();\r\ndate.setDate(date.getDate() - 3);\r\nlet initialDateFilter = `${date.getFullYear()}-`;\r\ninitialDateFilter += `${(date.getMonth() + 1).toString().padStart(2, '0')}-`;\r\ninitialDateFilter += `${date.getDate().toString().padStart(2, '0')}`;\r\n\r\nconst initialFilterModel = {\r\n    items: [{ columnField: 'receivedTime', operatorValue: 'onOrAfter', value: initialDateFilter }],\r\n} as GridFilterModelState;\r\n\r\n// const deepCompareFilterModelParams = (p1: GridFilterModelParams, p2: GridFilterModelParams): boolean => {\r\n//     const p1Items = p1.filterModel.items;\r\n//     const p2Items = p2.filterModel.items;\r\n\r\n//     if (p1Items.length !== p2Items.length || p1.filterModel.linkOperator !== p2.filterModel.linkOperator) {\r\n//         return false;\r\n//     }\r\n\r\n//     for (let i = 0; i < p1Items.length; i++) {\r\n//         if (\r\n//             p1Items[i].columnField !== p2Items[i].columnField ||\r\n//             p1Items[i].operatorValue !== p2Items[i].operatorValue ||\r\n//             p1Items[i].value !== p2Items[i].value\r\n//         ) {\r\n//             return false;\r\n//         }\r\n//     }\r\n\r\n//     return true;\r\n// };\r\n\r\nexport const ListingTable: FC = React.memo(() => {\r\n    const { listings, selectedListingId } = React.useContext(ListingContext);\r\n    const setSelectedListingId = useListingAction(ListingActionType.SelectListing);\r\n    const setHiddenListingIds = useListingAction(ListingActionType.SetHiddenListings);\r\n    // const errorContext = React.useContext(ErrorContext);\r\n\r\n    const onFilterModelChanged = React.useCallback(\r\n        (params: GridFilterModelParams) => {\r\n            setHiddenListingIds(listings?.filter((l) => !params.visibleRows.has(l.id)).map((l) => l.id) ?? null);\r\n        },\r\n        [setHiddenListingIds, listings]\r\n    );\r\n\r\n    const onRowSelected = React.useCallback((row: GridRowSelectedParams) => setSelectedListingId(row.data.id), [\r\n        setSelectedListingId,\r\n    ]);\r\n\r\n    const selectionModel = React.useMemo(() => {\r\n        return selectedListingId ? [selectedListingId] : undefined;\r\n    }, [selectedListingId]);\r\n\r\n    return (\r\n        <DataGrid\r\n            rows={listings ?? []}\r\n            columns={columns}\r\n            autoHeight\r\n            disableMultipleSelection\r\n            pagination\r\n            pageSize={10}\r\n            rowsPerPageOptions={[10, 25, 100]}\r\n            onRowSelected={onRowSelected}\r\n            filterModel={initialFilterModel}\r\n            onFilterModelChange={onFilterModelChanged}\r\n            selectionModel={selectionModel}\r\n        />\r\n    );\r\n});\r\n","import { Address } from '../schemas/address';\r\nimport { Listing } from '../schemas/listing';\r\nimport { DataResult } from '../schemas/result';\r\n\r\nexport const openListing = (listingId: number): void => {\r\n    const newTab = window.open(\r\n        `https://vow.mlspin.com/VOW/listingviews/GetListing?rm=1&vf=2&summ=false&o=2&od=1&f=0&ps=0&offs=0&sel=${listingId}&sp=false&cb=16190256`,\r\n        '_blank',\r\n        'noopener,noreferrer'\r\n    );\r\n    if (newTab) {\r\n        newTab.opener = null;\r\n    }\r\n};\r\n\r\nexport const scrapeSourceForListings = async (listingPage: string): Promise<DataResult<Listing[]>> => {\r\n    const parser = new DOMParser();\r\n    try {\r\n        const doc = parser.parseFromString(listingPage, 'text/html');\r\n\r\n        const listingRows = doc.querySelectorAll('tr[data-ListNo]');\r\n\r\n        const listings: Listing[] = [];\r\n        listingRows.forEach(async (listing) => {\r\n            const listingId = parseInt(listing.getAttribute('data-ListNo') ?? '0');\r\n            const bedBaths = parseBedAndBathCounts(listing.children.item(11)?.textContent ?? '');\r\n            const addressFull = listing.children?.item(9)?.textContent ?? '';\r\n            const parsedAddress = parseAddress(addressFull);\r\n            const now = new Date();\r\n            let rawDate = listing.children?.item(15)?.textContent;\r\n            // The listing does not include the year, so if it got pulled we need to manually add the year string\r\n            rawDate = rawDate?.length ? rawDate + now.getFullYear().toString() : now.toDateString();\r\n            const rawTime = listing.children?.item(16)?.textContent ?? now.toTimeString();\r\n            // This string probably has lots of nbsps, and we need to replace them with normal spaces\r\n            const parsedTime = new Date(Date.parse((rawDate + rawTime).replace(/\\s/g, ' ')) || 0);\r\n\r\n            listings.push({\r\n                id: listingId,\r\n                address: parsedAddress,\r\n                type: bedBaths.type,\r\n                price: parsePrice(listing.children.item(13)?.textContent ?? '0'),\r\n                bedCount: bedBaths.bedCount,\r\n                bathCount: bedBaths.bathCount,\r\n                receivedTime: parsedTime,\r\n                isViewed: false,\r\n            } as Listing);\r\n        });\r\n\r\n        return Promise.resolve({ success: true, data: listings });\r\n    } catch (err) {\r\n        return { success: false, error: err.toString() };\r\n    }\r\n};\r\n\r\nconst parseBedAndBathCounts = (content: string): { type: string; bedCount: number; bathCount: number } => {\r\n    const matches = /(?<bed>\\d)\\sbed,\\s(?<bathfull>\\d)f\\s(?<bathhalf>\\d)h\\sbath\\s(?<type>.*)/.exec(content);\r\n    const type = matches?.groups!['type']?.replace(/\\sx[\\d]+.*/, '');\r\n\r\n    return {\r\n        type: type ?? 'Unknown',\r\n        bedCount: parseInt(matches?.groups!['bed'] ?? '0'),\r\n        bathCount: parseInt(matches?.groups!['bathfull'] ?? '0') + 0.5 * parseInt(matches?.groups!['bathhalf'] ?? '0'),\r\n    };\r\n};\r\n\r\nconst parseAddress = (address: string): Address => {\r\n    // Addresses come to us in the format of '[number or range] [street] [U: unit#] [city], [state][optional :neighborhood]]'\r\n    try {\r\n        const addressLine = address.match(/.*MA.*/);\r\n        if (!addressLine?.length || addressLine.length !== 1) {\r\n            throw new Error('MA not found');\r\n        }\r\n\r\n        const matches = /(?<street>.*)\\s(?<city>[A-Za-z]+(?:\\s[A-Za-z]+)*), MA/.exec(addressLine[0]);\r\n        if (!matches?.groups) {\r\n            throw new Error('Could not split street/city');\r\n        }\r\n\r\n        // First remove the worthless unit number\r\n        let street = matches.groups['street'].trim();\r\n        const unitOffset = street.indexOf('U:');\r\n        const unit = unitOffset >= 0 ? street.slice(unitOffset + 2, street.length).trim() : null;\r\n        street = unitOffset >= 0 ? street.slice(0, unitOffset - 1) : street;\r\n        //const unitMatch = /(?:U:[\\s]*(?<unit>[\\w\\d]+))/.exec(matches.groups['street']);\r\n        //const street = matches.groups['street'].replace(/(?:U:[\\s]*[\\w\\d]+)/, '').trim();\r\n\r\n        return {\r\n            street: street,\r\n            unit: unit,\r\n            city: matches.groups['city'],\r\n            state: 'MA',\r\n        };\r\n    } catch (err) {\r\n        return {\r\n            street: err.toString(),\r\n            city: 'nowhere',\r\n            state: 'MA',\r\n        } as Address;\r\n    }\r\n};\r\n\r\nconst parsePrice = (priceString: string): number => {\r\n    try {\r\n        const priceMatch = priceString.match(/(?:\\$)([\\d,]+)/);\r\n        if (!priceMatch?.length || priceMatch.length !== 2) {\r\n            throw new Error(`Invalid price format: ${priceString}`);\r\n        }\r\n\r\n        return parseInt(priceMatch[1].replace(',', ''));\r\n    } catch (err) {\r\n        return 0;\r\n    }\r\n};\r\n","import { DataResult } from '../schemas/result';\r\nimport querystring from 'querystring';\r\nimport { NominatimResult } from '../schemas/nominatimResult';\r\nimport { ListingCoordinates } from '../schemas/listingCoordinates';\r\nimport { DelayQueue } from '../utility/delayQueue';\r\n\r\nconst geocodeQueue = new DelayQueue(1500);\r\n\r\nexport const lookupGeocodeAddress = async (\r\n    listingId: number,\r\n    addressQuery: string\r\n): Promise<DataResult<ListingCoordinates>> => {\r\n    try {\r\n        let cacheEntry = localStorage.getItem(listingId.toString());\r\n        if (!cacheEntry) {\r\n            cacheEntry = localStorage.getItem(addressQuery.toLocaleUpperCase());\r\n        }\r\n        if (cacheEntry) {\r\n            const coordinates = JSON.parse(cacheEntry);\r\n            if (coordinates.id !== listingId) {\r\n                coordinates.id = listingId;\r\n                const randomOffset = Math.random() * 2 * Math.PI;\r\n                coordinates.latitude = coordinates.latitude + Math.sin(randomOffset) * 0.00005;\r\n                coordinates.longitude = coordinates.longitude + Math.cos(randomOffset) * 0.00005;\r\n            }\r\n            return { success: true, data: coordinates };\r\n        }\r\n\r\n        await geocodeQueue.waitNext();\r\n\r\n        const query = {\r\n            q: addressQuery,\r\n            format: 'jsonv2',\r\n            limit: 1,\r\n            addressdetails: 1,\r\n            countrycodes: 'us',\r\n        };\r\n\r\n        const response = await fetch(`https://nominatim.openstreetmap.org/search?${querystring.encode(query)}`);\r\n\r\n        if (!response.ok) {\r\n            return { success: false, error: `Nominatim failed with status: ${response.status}` };\r\n        }\r\n\r\n        const data = (await response.json()) as NominatimResult[];\r\n\r\n        if (!data || !data.length || data.length !== 1) {\r\n            return { success: false, error: `Nominatim returned invalid result: ${data}` };\r\n        }\r\n\r\n        const coordinate = {\r\n            id: listingId,\r\n            latitude: parseFloat(data[0].lat),\r\n            longitude: parseFloat(data[0].lon),\r\n        } as ListingCoordinates;\r\n        const coordinateJson = JSON.stringify(coordinate);\r\n\r\n        localStorage.setItem(listingId.toString(), coordinateJson);\r\n        localStorage.setItem(addressQuery.toLocaleUpperCase(), coordinateJson);\r\n\r\n        return { success: true, data: coordinate };\r\n    } catch (err) {\r\n        return { success: false, error: err.toString() };\r\n    }\r\n};\r\n","interface QueueEntry {\r\n    resolve: () => void;\r\n    reject: (reason: string | Error) => void;\r\n}\r\n\r\nexport class DelayQueue {\r\n    private readonly _delay: number;\r\n    private readonly _queue: QueueEntry[];\r\n\r\n    private _isTicking: boolean;\r\n\r\n    constructor(delay: number) {\r\n        this._delay = delay;\r\n        this._queue = [];\r\n        this._isTicking = false;\r\n    }\r\n\r\n    public waitNext(): Promise<void> {\r\n        const promise = new Promise<void>((resolve, reject) => this._queue.push({ resolve, reject }));\r\n        if (!this._isTicking) {\r\n            this.startTick();\r\n        }\r\n\r\n        return promise;\r\n    }\r\n\r\n    private startTick(force = false): void {\r\n        if (this._isTicking && !force) {\r\n            return;\r\n        }\r\n\r\n        this._isTicking = true;\r\n        setTimeout(this.pop.bind(this), this._delay);\r\n    }\r\n\r\n    private pop(): void {\r\n        const nextItem = this._queue.shift();\r\n        if (!nextItem) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            nextItem.resolve();\r\n        } catch (err) {\r\n            // The handler might throw an error, and if so, send it to the reject\r\n            console.log(`DelayQueue callback threw error that was ignored: ${err}`);\r\n        }\r\n\r\n        if (!this._queue.length) {\r\n            this._isTicking = false;\r\n        } else {\r\n            this.startTick(true);\r\n        }\r\n    }\r\n}\r\n","import React, { FC } from 'react';\r\nimport { Popup } from './general/popup';\r\nimport { scrapeSourceForListings } from '../api/mlspin';\r\nimport { ErrorContext } from '../store/errorContext';\r\nimport { lookupGeocodeAddress } from '../api/osmNominatim';\r\nimport { makeStyles, TextField } from '@material-ui/core';\r\nimport { ListingActionType } from '../store/listingActions';\r\nimport { useListingAction } from '../store/listingHooks';\r\n\r\ninterface SourceInputPopupProps {\r\n    isOpen: boolean;\r\n    close: () => void;\r\n}\r\n\r\nexport const useStyles = makeStyles(() => ({\r\n    sourceInput: {\r\n        width: '80vw',\r\n    },\r\n}));\r\n\r\nexport const SourceInputPopup: FC<SourceInputPopupProps> = ({ isOpen, close }: SourceInputPopupProps) => {\r\n    const [sourceString, setSourceString] = React.useState<string | undefined>();\r\n    const errorContext = React.useContext(ErrorContext);\r\n    const setIsImporting = useListingAction(ListingActionType.SetIsImporting);\r\n    const addListings = useListingAction(ListingActionType.AddListings);\r\n    const addCoordinate = useListingAction(ListingActionType.AddCoordinate);\r\n\r\n    const classes = useStyles();\r\n\r\n    const parseAndSaveListings = async () => {\r\n        if (!sourceString) {\r\n            errorContext.addError('Please enter source information.');\r\n            return;\r\n        }\r\n\r\n        setIsImporting(true);\r\n\r\n        const parseResult = await scrapeSourceForListings(sourceString);\r\n        if (!parseResult.success || !parseResult.data?.length) {\r\n            errorContext.addError(`Tell Jeff the parse isn't working: ${parseResult.error?.toString()}`);\r\n            return;\r\n        }\r\n\r\n        close();\r\n        addListings(parseResult.data);\r\n\r\n        for (const listing of parseResult.data) {\r\n            const coordinatesResult = await lookupGeocodeAddress(\r\n                listing.id,\r\n                `${listing.address.street}, ${listing.address.city}, ${listing.address.state}`\r\n            );\r\n\r\n            if (!coordinatesResult.success || !coordinatesResult.data) {\r\n                console.log(`Failed to get coordinates for ${listing.address.street}: ${coordinatesResult.error}`);\r\n                continue;\r\n            }\r\n\r\n            addCoordinate(coordinatesResult.data);\r\n        }\r\n\r\n        setIsImporting(false);\r\n    };\r\n\r\n    return (\r\n        <Popup\r\n            title=\"Input MLS Page\"\r\n            isOpen={isOpen}\r\n            onConfirm={parseAndSaveListings}\r\n            confirmButtonLabel=\"Import\"\r\n            onCancel={close}\r\n        >\r\n            <TextField\r\n                className={classes.sourceInput}\r\n                multiline\r\n                fullWidth\r\n                rows={10}\r\n                rowsMax={30}\r\n                placeholder=\"Paste page source here...\"\r\n                variant=\"outlined\"\r\n                onChange={(s) => setSourceString(s.currentTarget.value)}\r\n            />\r\n        </Popup>\r\n    );\r\n};\r\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACJ0lEQVR4Ae3ShY6bQRADYIeZ3v+9yszMDZPlkSWtslPuiS6+C+8n/zNp4p/froi8Jq/Jxk+TkwmHX//Wz8lG3jNjTeaguabD6HAVbphMwIIzqtd+rzKYhsgUNNcqo3fEBlyyOWmwhbbS4b8SaLBu7SGlpL9gklw3YpYR6J5Bm0zAguspZjvqSVQxqvxsPSJJKYIFKh5A2VIDyMgYfYB9hvcmI0VPTxVZS81ER7qiBoFqBAa9MKOKLzzv2BE3EOnlmDTrNRXryToGOGR65nhvSphjMP6b6WJ6xMYYxSW7l1Pp6CSzbLFPgAN3NGLKPRn3c59qxzapCTPUFNVKh0vUe24azMkW+uRm/B8UU3O3Eiw4nOrrafOSF5gS7PqHUotBQQ6f11p22HDOi+66i2LIHcWJOZrTP+rkhOl7n8YcTzCQIuIvyZPQrvs5Br0OdTsyB+YYrwKokXvsgOIXZzbeQ0DMnhHIqGOdBMEl9qKYAo3pBbbDNkijUSgjv/PrMFhwRwS2YbbMzqg+SzdukoxbeiSEVlgyK6yFmjSYtDxhTXRv1OsgsCb2jflu8hLMyC0P7Qg54NE1qc/MF5PqeAHWSfDL3zxN9dsQ+YD3zEeRS4GeYgFm5I7HNiJPfP4V7/CKeUvwsxpqhkwFzMgjj33Vwe+EnuIxngn8FvNTSCkwmJG+rQm8J/MId/EQL3nZwe2EmSNm9ufkFq9xHzcJPscnLGMRomBKqdzOY2EH+IPOLMEAAAAASUVORK5CYII=\"","import React, { FC } from 'react';\r\nimport { ListingContext } from '../store/listingStore';\r\nimport { Button, Grid, makeStyles, Typography } from '@material-ui/core';\r\nimport { MapContainer, Marker, Popup, TileLayer } from 'react-leaflet';\r\nimport { Map as LeafletMap, Icon } from 'leaflet';\r\nimport { openListing } from '../api/mlspin';\r\nimport { currencyFormatter } from '../utility/currencyFormatter';\r\nimport BlueIcon from '../styles/images/marker-icon-blue.png';\r\nimport PurpleIcon from '../styles/images/marker-icon-violet.png';\r\nimport MarkerShadow from '../styles/images/marker-shadow.png';\r\nimport { useListingAction } from '../store/listingHooks';\r\nimport { ListingActionType } from '../store/listingActions';\r\n// import { ErrorContext } from '../context/errorContext';\r\n\r\nconst useStyles = makeStyles({\r\n    map: {\r\n        width: '100%',\r\n        height: '50vh',\r\n        margin: '1rem 0',\r\n    },\r\n    listingType: {\r\n        textTransform: 'capitalize',\r\n    },\r\n});\r\n\r\nconst blueMarkerIcon = new Icon({\r\n    iconUrl: BlueIcon,\r\n    shadowUrl: MarkerShadow,\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    popupAnchor: [1, -34],\r\n    shadowSize: [41, 41],\r\n});\r\n\r\nconst purpleMarkerIcon = new Icon({\r\n    iconUrl: PurpleIcon,\r\n    shadowUrl: MarkerShadow,\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    popupAnchor: [1, -34],\r\n    shadowSize: [41, 41],\r\n});\r\n\r\nexport const ListingMap: FC = () => {\r\n    const listingContext = React.useContext(ListingContext);\r\n    // const errorContext = React.useContext(ErrorContext);\r\n    const setSelectedListingId = useListingAction(ListingActionType.SelectListing);\r\n    const markListingAsViewed = useListingAction(ListingActionType.SetListingAsViewed);\r\n\r\n    const classes = useStyles();\r\n\r\n    const mapRef = React.useRef<LeafletMap>();\r\n\r\n    // React.useEffect(() => {\r\n    //     if (mapRef.current) {\r\n    //         mapRef.current.eachLayer((layer) => {\r\n    //             console.log(layer);\r\n    //         });\r\n    //     }\r\n    // }, [listingContext.selectedListingId, mapRef.current]);\r\n\r\n    return (\r\n        <Grid item>\r\n            <MapContainer\r\n                center={[42.41, -71.15]}\r\n                zoom={11.6}\r\n                scrollWheelZoom\r\n                className={classes.map}\r\n                whenCreated={(map) => (mapRef.current = map)}\r\n            >\r\n                <TileLayer\r\n                    attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n                    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                />\r\n                {listingContext.coordinates?.reduce((markers, coordinates) => {\r\n                    const listing = listingContext.listings?.find((l) => l.id === coordinates.id);\r\n                    if (!listing || listingContext.hiddenListingIds?.has(listing.id)) {\r\n                        return markers;\r\n                    }\r\n\r\n                    markers.push(\r\n                        <Marker\r\n                            key={coordinates.id}\r\n                            position={[coordinates.latitude, coordinates.longitude]}\r\n                            eventHandlers={{\r\n                                click: (_) => setSelectedListingId(coordinates.id),\r\n                            }}\r\n                            icon={listing.isViewed ? purpleMarkerIcon : blueMarkerIcon}\r\n                        >\r\n                            <Popup>\r\n                                <Grid container direction=\"column\" alignItems=\"center\">\r\n                                    <Grid item>\r\n                                        <Typography component=\"b\">{listing.address.street}</Typography>\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <Typography component=\"b\">\r\n                                            {listing.address.unit ? `Unit: ${listing.address.unit}` : ''}\r\n                                        </Typography>\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <Typography component=\"b\" className={classes.listingType}>\r\n                                            {listing.type}\r\n                                        </Typography>\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <Typography component=\"b\">{currencyFormatter.format(listing.price)}</Typography>\r\n                                    </Grid>\r\n                                    <Grid item>\r\n                                        <Typography component=\"b\">\r\n                                            Listed on&nbsp;\r\n                                            {listing.receivedTime.toLocaleDateString('en-US', {\r\n                                                month: 'long',\r\n                                                day: 'numeric',\r\n                                            })}\r\n                                        </Typography>\r\n                                    </Grid>\r\n                                    <Button\r\n                                        variant=\"contained\"\r\n                                        color=\"primary\"\r\n                                        onClick={() => {\r\n                                            openListing(listing.id);\r\n                                            markListingAsViewed(listing.id);\r\n                                        }}\r\n                                    >\r\n                                        Open Listing\r\n                                    </Button>\r\n                                </Grid>\r\n                            </Popup>\r\n                        </Marker>\r\n                    );\r\n                    return markers;\r\n                }, [] as React.ReactNode[])}\r\n            </MapContainer>\r\n        </Grid>\r\n    );\r\n};\r\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import { Fab, Grid, makeStyles } from '@material-ui/core';\r\nimport AddIcon from '@material-ui/icons/Add';\r\nimport React, { FC } from 'react';\r\nimport { ErrorContext } from '../store/errorContext';\r\nimport { ListingContext } from '../store/listingStore';\r\nimport { ListingTable } from './listingTable';\r\nimport { SourceInputPopup } from './sourceInputPopup';\r\nimport { ListingMap } from './listingMap';\r\nimport { useListingAction } from '../store/listingHooks';\r\nimport { ListingActionType } from '../store/listingActions';\r\n\r\nconst useStyles = makeStyles({\r\n    mainContainer: {\r\n        margin: '0 5rem',\r\n        width: 'auto',\r\n    },\r\n    addButton: {\r\n        position: 'fixed',\r\n        margin: 0,\r\n        top: 'auto',\r\n        right: 20,\r\n        bottom: 20,\r\n        left: 'auto',\r\n    },\r\n});\r\n\r\nexport const Main: FC = () => {\r\n    const listingContext = React.useContext(ListingContext);\r\n    const [errors, setErrors] = React.useState<string[] | null>(null);\r\n    const [isSourceInputOpen, setIsSourceInputOpen] = React.useState<boolean>(!listingContext.listings?.length);\r\n    const deleteListings = useListingAction(ListingActionType.DeleteListings);\r\n    const deleteCoordinates = useListingAction(ListingActionType.DeleteCoordinates);\r\n\r\n    const addError = (error: string) => {\r\n        setErrors([...(errors ?? []), error]);\r\n    };\r\n\r\n    const clearErrors = () => setErrors(null);\r\n\r\n    const classes = useStyles();\r\n\r\n    React.useEffect(() => {\r\n        if (!listingContext.listings?.length) {\r\n            return;\r\n        }\r\n\r\n        // Do not load any listings that are older than 2 weeks old\r\n        const listingDateExpiration = new Date();\r\n        listingDateExpiration.setDate(listingDateExpiration.getDate() - 14);\r\n\r\n        const activeListingIds = new Set<number>();\r\n        const listingsToDelete = listingContext.listings\r\n            .filter((l) => {\r\n                if (l.receivedTime < listingDateExpiration) {\r\n                    return true;\r\n                } else {\r\n                    activeListingIds.add(l.id);\r\n                    return false;\r\n                }\r\n            })\r\n            .map((l) => l.id);\r\n\r\n        const coordinatesToDelete = listingContext.coordinates\r\n            ?.filter((c) => !activeListingIds.has(c.id))\r\n            .map((c) => c.id);\r\n\r\n        // Perform the deletions\r\n        if (listingsToDelete.length) {\r\n            deleteListings(listingsToDelete);\r\n        }\r\n        if (coordinatesToDelete?.length) {\r\n            deleteCoordinates(coordinatesToDelete);\r\n        }\r\n    }, [listingContext.listings, listingContext.coordinates, deleteListings, deleteCoordinates]);\r\n\r\n    return (\r\n        <ErrorContext.Provider value={{ errors, addError, clearAll: clearErrors }}>\r\n            <Grid container direction=\"column\" className={classes.mainContainer}>\r\n                <SourceInputPopup isOpen={isSourceInputOpen} close={() => setIsSourceInputOpen(false)} />\r\n                <ListingMap />\r\n                <ListingTable />\r\n            </Grid>\r\n            <Fab\r\n                color=\"primary\"\r\n                size=\"medium\"\r\n                className={classes.addButton}\r\n                aria-label=\"add\"\r\n                onClick={() => setIsSourceInputOpen(true)}\r\n                disabled={isSourceInputOpen}\r\n            >\r\n                <AddIcon />\r\n            </Fab>\r\n        </ErrorContext.Provider>\r\n    );\r\n};\r\n","import { Theme, createMuiTheme } from '@material-ui/core/styles';\r\n\r\nexport const DefaultTheme: Theme = createMuiTheme({\r\n    palette: {\r\n        type: 'dark',\r\n    },\r\n    shape: {\r\n        borderRadius: 1,\r\n    },\r\n    overrides: {\r\n        MuiCssBaseline: {\r\n            '@global': {\r\n                body: {\r\n                    margin: 0,\r\n                    fontFamily: [\r\n                        '-apple-system',\r\n                        'BlinkMacSystemFont',\r\n                        'Segoe UI',\r\n                        'Roboto',\r\n                        'Oxygen',\r\n                        'Ubuntu',\r\n                        'Cantarell',\r\n                        'Fira Sans',\r\n                        'Droid Sans',\r\n                        'Helvetica Neue',\r\n                        'sans-serif',\r\n                    ].join('.'),\r\n                    height: '100%',\r\n                },\r\n                html: {\r\n                    height: '100%',\r\n                },\r\n            },\r\n        },\r\n    },\r\n});\r\n","import { CssBaseline, ThemeProvider } from '@material-ui/core';\r\nimport React, { FC } from 'react';\r\nimport { ErrorHandler } from './components/general/errorHandler';\r\nimport { Main } from './components/main';\r\nimport { ListingProvider } from './store/listingStore';\r\nimport { DefaultTheme } from './styles/theme';\r\n\r\nexport const App: FC = () => {\r\n    return (\r\n        // Highest level applies the default Material UI theme to everything\r\n        <ThemeProvider theme={DefaultTheme}>\r\n            {/* MUI helper to standardize the CSS for the application */}\r\n            <CssBaseline />\r\n            <ErrorHandler>\r\n                <ListingProvider>\r\n                    <Main />\r\n                </ListingProvider>\r\n            </ErrorHandler>\r\n        </ThemeProvider>\r\n    );\r\n};\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n// import reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <App />\r\n    </React.StrictMode>,\r\n    document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\n//reportWebVitals();\r\n"],"sourceRoot":""}